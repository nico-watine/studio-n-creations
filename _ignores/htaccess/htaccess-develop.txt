# ---------------------------------------------------------------------
# |            Apache Server Configs v2.14.0 | MIT License            |
# ---------------------------------------------------------------------


# ----------------------------------------------------------------------
# | Cross-origin images                                                |
# ----------------------------------------------------------------------

<IfModule mod_setenvif.c>
    <IfModule mod_headers.c>
        <FilesMatch "\.(bmp|cur|gif|ico|jpe?g|png|svgz?|webp)$">
            SetEnvIf Origin ":" IS_CORS
            Header set Access-Control-Allow-Origin "*" env=IS_CORS
        </FilesMatch>
    </IfModule>
</IfModule>


# ----------------------------------------------------------------------
# | Error prevention                                                   |
# ----------------------------------------------------------------------

Options -MultiViews


# ----------------------------------------------------------------------
# | Custom error messages/pages                                        |
# ----------------------------------------------------------------------

ErrorDocument 403 /403.html

ErrorDocument 404 /404.html


# ----------------------------------------------------------------------
# | Character encodings                                                |
# ----------------------------------------------------------------------

<IfModule mod_mime.c>
    AddCharset utf-8 .js \
                     .json \
                     .jsonld \
                     .manifest
</IfModule>


# ----------------------------------------------------------------------
# | Rewrite engine                                                     |
# ----------------------------------------------------------------------

<IfModule mod_rewrite.c>

    RewriteEngine On

    Options +FollowSymlinks

    RewriteCond %{HTTPS} =on
    RewriteRule ^ - [env=proto:https]
    RewriteCond %{HTTPS} !=on
    RewriteRule ^ - [env=proto:http]

</IfModule>


# --------------------------------------------------------------------
# |            Remove the `www.` at the beginning of URLs            |
# --------------------------------------------------------------------

# Rewrite www.studioncreations.com → studioncreations.com

<IfModule mod_rewrite.c>
    RewriteEngine On
    RewriteCond %{HTTPS} !=on
    RewriteCond %{HTTP_HOST} ^www\.(.+)$ [NC]
    RewriteRule ^ %{ENV:PROTO}://%1%{REQUEST_URI} [R=301,L]
</IfModule>


# ------------------------------------------------------------------------------
# | Remove & Redirect 'HTML' / 'PHP' / 'HTM' Endings                           |
# ------------------------------------------------------------------------------

RewriteOptions inherit

RewriteEngine on
#example.com/page will display the contents of example.com/page.php
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteCond %{REQUEST_FILENAME}.php -f
RewriteRule ^(.+)$ $1.php [L,QSA]

#example.com/page will display the contents of example.com/page.html
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteCond %{REQUEST_FILENAME}.html -f
RewriteRule ^(.+)$ $1.html [L,QSA]

#301 from example.com/page.php to example.com/page
RewriteCond %{THE_REQUEST} ^[A-Z]{3,9}\ /.*\.php\ HTTP/
RewriteRule ^(.*)\.php$ /$1 [R=301,L]

#301 from example.com/page.htm to example.com/page
RewriteCond %{THE_REQUEST} ^[A-Z]{3,9}\ /.*\.htm\ HTTP/
RewriteRule ^(.*)\.htm$ /$1 [R=301,L]

#301 from example.com/page.html to example.com/page
RewriteCond %{THE_REQUEST} ^[A-Z]{3,9}\ /.*\.html\ HTTP/
RewriteRule ^(.*)\.html$ /$1 [R=301,L]


# ----------------------------------------------------------------------
# | File access                                                        |
# ----------------------------------------------------------------------

<IfModule mod_autoindex.c>
    Options -Indexes
</IfModule>


<IfModule mod_rewrite.c>
    RewriteEngine On
    RewriteCond %{REQUEST_URI} "!(^|/)\.well-known/([^./]+./?)+$" [NC]
    RewriteCond %{SCRIPT_FILENAME} -d [OR]
    RewriteCond %{SCRIPT_FILENAME} -f
    RewriteRule "(^|/)\." - [F]
</IfModule>


<FilesMatch "(^#.*#|\.(bak|conf|dist|fla|in[ci]|log|psd|sh|sql|sw[op])|~)$">

    # Apache < 2.3
    <IfModule !mod_authz_core.c>
        Order allow,deny
        Deny from all
        Satisfy All
    </IfModule>

    # Apache ≥ 2.3
    <IfModule mod_authz_core.c>
        Require all denied
    </IfModule>

</FilesMatch>


# ----------------------------------------------------------------------
# | Reducing MIME type security risks                                  |
# ----------------------------------------------------------------------

<IfModule mod_headers.c>
    Header set X-Content-Type-Options "nosniff"
</IfModule>


# ----------------------------------------------------------------------
# | Server-side technology information                                 |
# ----------------------------------------------------------------------

<IfModule mod_headers.c>
    Header unset X-Powered-By
</IfModule>


# ----------------------------------------------------------------------
# | Server software information                                        |
# ----------------------------------------------------------------------

ServerSignature Off


# ------------------------------------------------------------------------------
# | Rules for Versioned Static Files
# ------------------------------------------------------------------------------

RewriteRule ^(js|css)/(.+)\.(.+)\.(js|css)$ $1/$2.$4 [L]


# ---------------------------------------
# |            URL Redirects            |
# ---------------------------------------

# /our-services -> /our-services/web-development
RewriteCond %{HTTP_HOST} ^studioncreations\.com$ [OR]
RewriteCond %{HTTP_HOST} ^www\.studioncreations\.com$
RewriteRule ^our\-services$ "http\:\/\/studioncreations\.com\/our\-services\/web\-development" [R=301,L]

# /our-services/index -> /our-services/web-development
RewriteCond %{HTTP_HOST} ^studioncreations\.com$ [OR]
RewriteCond %{HTTP_HOST} ^www\.studioncreations\.com$
RewriteRule ^our\-services\/index$ "http\:\/\/studioncreations\.com\/our\-services\/web\-development" [R=301,L]

# /our-services/ -> /our-services/web-development
RewriteCond %{HTTP_HOST} ^studioncreations\.com$ [OR]
RewriteCond %{HTTP_HOST} ^www\.studioncreations\.com$
RewriteRule ^our\-services\/$ "http\:\/\/studioncreations\.com\/our\-services\/web\-development" [R=301,L]

